<!-- Random Posts Discovery - Left Sidebar -->
<aside class="random-posts-sidebar">
  <h3 class="random-posts-sidebar__title"><i class="fas fa-compass"></i> Discover Posts</h3>
  
  {% assign all_posts = site.posts %}
  {% if all_posts.size > 0 %}
    <!-- Create a pseudo-random selection by using different starting points -->
    {% assign day_of_year = site.time | date: "%j" | plus: 0 %}
    {% assign posts_count = all_posts.size %}
    {% assign start_index = day_of_year | modulo: posts_count %}
    
    <div class="random-posts-list">
      {% assign displayed_count = 0 %}
      {% assign current_index = start_index %}
      
      {% for i in (1..6) %}
        {% if displayed_count < 6 and current_index < posts_count %}
          {% assign post = all_posts[current_index] %}
          <article class="random-post-card">
            <h4 class="random-post-card__title">
              <a href="{{ post.url }}" class="random-post-card__link">
                {{ post.title | truncate: 55 }}
              </a>
            </h4>
            
            <div class="random-post-card__meta">
              <time datetime="{{ post.date | date_to_xmlschema }}" class="random-post-card__date">
                <i class="fas fa-calendar-alt"></i>
                {{ post.date | date: "%b %d, %Y" }}
              </time>
              
              {% if post.tags and post.tags.size > 0 %}
                <div class="random-post-card__tags">
                  {% for tag in post.tags limit: 2 %}
                    <span class="random-post-card__tag">#{{ tag }}</span>
                  {% endfor %}
                </div>
              {% endif %}
            </div>
            
            {% if post.excerpt %}
              <p class="random-post-card__excerpt">
                {{ post.excerpt | strip_html | truncate: 90 }}
              </p>
            {% endif %}
          </article>
          {% assign displayed_count = displayed_count | plus: 1 %}
        {% endif %}
        
        <!-- Move to next post with wrapping -->
        {% assign current_index = current_index | plus: 3 %}
        {% if current_index >= posts_count %}
          {% assign current_index = current_index | modulo: posts_count %}
        {% endif %}
      {% endfor %}
    </div>
  {% else %}
    <p>No posts found yet. Start writing your first blog post!</p>
  {% endif %}
  
  <div class="random-posts-sidebar__footer">
    <button type="button" class="shuffle-posts-btn" onclick="shufflePosts()" aria-label="Shuffle random posts">
      <i class="fas fa-shuffle"></i> Shuffle Posts
    </button>
    <a href="/posts/" class="view-all-posts-link" aria-label="View all blog posts">
      â†’ View All Posts
    </a>
  </div>
</aside>

<script>
function shufflePosts() {
  const postsList = document.querySelector('.random-posts-list');
  const posts = Array.from(postsList.children);
  
  // Fisher-Yates shuffle algorithm
  for (let i = posts.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [posts[i], posts[j]] = [posts[j], posts[i]];
  }
  
  // Re-append shuffled posts
  posts.forEach(post => postsList.appendChild(post));
  
  // Add a subtle animation to indicate shuffle
  postsList.style.opacity = '0.7';
  setTimeout(() => {
    postsList.style.opacity = '1';
  }, 150);
}

// Auto-shuffle on page load to ensure randomness
document.addEventListener('DOMContentLoaded', function() {
  // Add a small delay to ensure DOM is fully loaded
  setTimeout(shufflePosts, 100);
});
</script>